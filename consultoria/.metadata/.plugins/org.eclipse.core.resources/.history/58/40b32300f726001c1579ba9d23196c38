package br.com.mattec.consul.util;


import java.io.IOException;
import java.io.OutputStream;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 *
 * @author Joe Loco
 */
public class BarcodeServlet extends HttpServlet {

	private static final long serialVersionUID = 1L;

	protected void processRequest(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {
			
			
        
        OutputStream out = response.getOutputStream();
        try {
			if(request.getParameter(&quot;code&quot;)!=null) {// aki o maldito numero 
				response.setContentType(&quot;image/gif&quot;);
				Long code = new Long(request.getParameter(&quot;code&quot;));
				Barcode b = new BarcodeEAN();
				b.setCodeType(Barcode.EAN13);
				b.setCode(BarCodeUtils.longToEan13(code));
				b.setBarHeight(50);				

				Image i = b.createAwtImage(new Color(0,0,0),new Color(255,255,255));			
				JFrame f = new JFrame();				
				BufferedImage bi = new BufferedImage(100,50, BufferedImage.TYPE_INT_RGB);								
				Graphics2D g = bi.createGraphics();   
				g.setBackground(new Color(255,255,255));
				g.clearRect(0,0,100,50);
				g.drawImage(i, 0, 0, f);			
				ImageIO.write(bi, &quot;gif&quot;, out);			
			}
        } finally { 
            out.close();
        }
    } 

   
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {
        processRequest(request, response);
    } 

  
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {
        processRequest(request, response);
    }

    /** 
    * Returns a short description of the servlet.
    */
    public String getServletInfo() {
        return &quot;Short description&quot;;
    }
   
}